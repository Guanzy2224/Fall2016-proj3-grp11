img0 <-  readImage(imgName)
img1 <- as.matrix(img0[,,1])
img2 <- as.matrix(img0[,,2])
img3 <- as.matrix(img0[,,3])
class(img1) <- "matrix"
class(img2) <- "matrix"
class(img3) <- "matrix"
feature1 <- glcm(raster(img1) , window = WINDOW, shift = SHIFT)
feature2 <- glcm(raster(img2) , window = WINDOW, shift = SHIFT)
feature3 <- glcm(raster(img3) , window = WINDOW, shift = SHIFT)
ndim=dim(feature1)
feature1=as.array(feature1)
feature2=as.array(feature2)
feature3=as.array(feature3)
dim(feature1)=c(ndim[1]*ndim[2],ndim[3])
dim(feature2)=c(ndim[1]*ndim[2],ndim[3])
dim(feature3)=c(ndim[1]*ndim[2],ndim[3])
feature1=as.matrix(feature1)
feature2=as.matrix(feature2)
feature3=as.matrix(feature3)
feature=cbind(feature1,feature2,feature3)
feature=na.omit(feature)
return(feature)
}
dogFeature=chickFeature=matrix(0,ncol=24)
for(i in 1:6){
imgName=sprintf("%d.jpg",i)
temp=getFeature(imgName)
dogFeature=rbind(dogFeature,temp)
}
View(dogFeature)
getFeature <- function(imgName = "name of feature image",WINDOW=c(31,31),SHIFT=c(10,10)){
img0 <-  readImage(imgName)
img1 <- as.matrix(img0[,,1])
img2 <- as.matrix(img0[,,2])
img3 <- as.matrix(img0[,,3])
class(img1) <- "matrix"
class(img2) <- "matrix"
class(img3) <- "matrix"
feature1 <- glcm(raster(img1) , window = WINDOW, shift = SHIFT)
feature2 <- glcm(raster(img2) , window = WINDOW, shift = SHIFT)
feature3 <- glcm(raster(img3) , window = WINDOW, shift = SHIFT)
ndim=dim(feature1)
feature1=as.array(feature1)
feature2=as.array(feature2)
feature3=as.array(feature3)
dim(feature1)=c(ndim[1]*ndim[2],ndim[3])
dim(feature2)=c(ndim[1]*ndim[2],ndim[3])
dim(feature3)=c(ndim[1]*ndim[2],ndim[3])
feature1=as.matrix(feature1)
feature2=as.matrix(feature2)
feature3=as.matrix(feature3)
feature=cbind(feature1,feature2,feature3)
feature=na.omit(feature)
return(feature)
}
setwd("C:/Users/Administrator/Desktop/proj 3/try4/fur")
dogFeature=chickFeature=matrix(0,ncol=24)
for(i in 1:6){
imgName=sprintf("%d.jpg",i)
temp=getFeature(imgName)
dogFeature=rbind(dogFeature,temp)
}
setwd("C:/Users/Administrator/Desktop/proj 3/try4/chick")
chickFeature=chickFeature=matrix(0,ncol=24)
for(i in 1:6){
imgName=sprintf("%d.jpg",i)
temp=getFeature(imgName)
chickFeature=rbind(chickFeature,temp)
}
dogFeature[,25]=1
temp2=rbind(dogFeature,chickFeature)
scaleSD=apply(temp2,2,sd)
scaleSD
dogFeature=t(t(dogFeature)/scaleSD)
head(dogFeature)
setwd("C:/Users/Administrator/Desktop/proj 3/try4/fur")
dogFeature=chickFeature=matrix(0,ncol=24)
for(i in 1:6){
imgName=sprintf("%d.jpg",i)
temp=getFeature(imgName)
dogFeature=rbind(dogFeature,temp)
}
dogFeature=dogFeature[-1,]
setwd("C:/Users/Administrator/Desktop/proj 3/try4/chick")
chickFeature=chickFeature=matrix(0,ncol=24)
for(i in 1:6){
imgName=sprintf("%d.jpg",i)
temp=getFeature(imgName)
chickFeature=rbind(chickFeature,temp)
}
chickFeature=chickFeature[-1,]
temp2=rbind(dogFeature,chickFeature)
scaleSD=apply(temp2,2,sd)
dogFeature=t(t(dogFeature)/scaleSD)
chickFeature=t(t(chickFeature)/scaleSD)
library(EBImage)
library(glcm)
library(raster)
library(jpeg)
library(class)
getFeature <- function(imgName = "name of feature image",WINDOW=c(31,31),SHIFT=c(10,10)){
img0 <-  readImage(imgName)
img1 <- as.matrix(img0[,,1])
img2 <- as.matrix(img0[,,2])
img3 <- as.matrix(img0[,,3])
class(img1) <- "matrix"
class(img2) <- "matrix"
class(img3) <- "matrix"
feature1 <- glcm(raster(img1) , window = WINDOW, shift = SHIFT)
feature2 <- glcm(raster(img2) , window = WINDOW, shift = SHIFT)
feature3 <- glcm(raster(img3) , window = WINDOW, shift = SHIFT)
ndim=dim(feature1)
feature1=as.array(feature1)
feature2=as.array(feature2)
feature3=as.array(feature3)
dim(feature1)=c(ndim[1]*ndim[2],ndim[3])
dim(feature2)=c(ndim[1]*ndim[2],ndim[3])
dim(feature3)=c(ndim[1]*ndim[2],ndim[3])
feature1=as.matrix(feature1)
feature2=as.matrix(feature2)
feature3=as.matrix(feature3)
feature=cbind(feature1,feature2,feature3)
feature=na.omit(feature)
return(feature)
}
setwd("C:/Users/Administrator/Desktop/proj 3/try4/fur")
dogFeature=matrix(0,ncol=24)
for(i in 1:6){
imgName=sprintf("%d.jpg",i)
temp=getFeature(imgName)
dogFeature=rbind(dogFeature,temp)
}
dogFeature=dogFeature[-1,]
setwd("C:/Users/Administrator/Desktop/proj 3/try4/chick")
chickFeature=matrix(0,ncol=24)
for(i in 1:6){
imgName=sprintf("%d.jpg",i)
temp=getFeature(imgName)
chickFeature=rbind(chickFeature,temp)
}
chickFeature=chickFeature[-1,]
setwd("C:/Users/Administrator/Desktop/proj 3/try4/noise")
noiseFeature=matrix(0,ncol=24)
for(i in 1:6){
imgName=sprintf("%d.jpg",i)
temp=getFeature(imgName)
noiseFeature=rbind(noiseFeature,temp)
}
noiseFeature=noiseFeature[-1,]
temp2=rbind(dogFeature,chickFeature)
scaleSD=apply(temp2,2,sd)
dogFeature=t(t(dogFeature)/scaleSD)
chickFeature=t(t(chickFeature)/scaleSD)
noiseFeature=t(t(noiseFeature)/scaleSD)
setwd("C:/Users/Administrator/Desktop/proj 3/try4/noise")
noiseFeature=matrix(0,ncol=24)
for(i in 1:4){
imgName=sprintf("%d.jpg",i)
temp=getFeature(imgName)
noiseFeature=rbind(noiseFeature,temp)
}
noiseFeature=noiseFeature[-1,]
temp2=rbind(dogFeature,chickFeature)
scaleSD=apply(temp2,2,sd)
dogFeature=t(t(dogFeature)/scaleSD)
chickFeature=t(t(chickFeature)/scaleSD)
noiseFeature=t(t(noiseFeature)/scaleSD)
setwd("C:/Users/Administrator/Desktop/proj 3/try4/test")
imgName="chicken_0039.jpg"
testFeature=getFeature(imgName)
aaa=array(c(1,2,3,4,5,6,7,8,9,10,11,12),dim=c(2,3,2))
aaa
dim(aaa)=c(6,2)
aaa
dim(aaa)=c(2,3,2)
aaa
img0 <-  readImage(imgName)
dim(img0)
dim(testFeature)
getTestFeature <- function(imgName = "name of feature image",WINDOW=c(31,31),SHIFT=c(10,10)){
img0 <-  readImage(imgName)
img1 <- as.matrix(img0[,,1])
img2 <- as.matrix(img0[,,2])
img3 <- as.matrix(img0[,,3])
class(img1) <- "matrix"
class(img2) <- "matrix"
class(img3) <- "matrix"
feature1 <- glcm(raster(img1) , window = WINDOW, shift = SHIFT)
feature2 <- glcm(raster(img2) , window = WINDOW, shift = SHIFT)
feature3 <- glcm(raster(img3) , window = WINDOW, shift = SHIFT)
ndim=dim(feature1)
feature1=as.array(feature1)
feature2=as.array(feature2)
feature3=as.array(feature3)
dim(feature1)=c(ndim[1]*ndim[2],ndim[3])
dim(feature2)=c(ndim[1]*ndim[2],ndim[3])
dim(feature3)=c(ndim[1]*ndim[2],ndim[3])
feature1=as.matrix(feature1)
feature2=as.matrix(feature2)
feature3=as.matrix(feature3)
feature=cbind(feature1,feature2,feature3)
feature[is.na(feature)]=0
return(feature)
}
setwd("C:/Users/Administrator/Desktop/proj 3/try4/test")
imgName="chicken_0039.jpg"
testFeature=getFeature(imgName)
img0 <-  readImage(imgName)
dim(img0)
dim(testFeature)
599*731
imgName="chicken_0039.jpg"
img0 <-  readImage(imgName)
img1 <- as.matrix(img0[,,1])
img2 <- as.matrix(img0[,,2])
img3 <- as.matrix(img0[,,3])
class(img1) <- "matrix"
class(img2) <- "matrix"
class(img3) <- "matrix"
feature1 <- glcm(raster(img1) , window = WINDOW, shift = SHIFT)
feature2 <- glcm(raster(img2) , window = WINDOW, shift = SHIFT)
feature3 <- glcm(raster(img3) , window = WINDOW, shift = SHIFT)
dim(feature1)
ndim=dim(feature1)
feature1=as.array(feature1)
feature2=as.array(feature2)
feature3=as.array(feature3)
dim(feature1)
dim(feature1)=c(ndim[1]*ndim[2],ndim[3])
dim(feature2)=c(ndim[1]*ndim[2],ndim[3])
dim(feature3)=c(ndim[1]*ndim[2],ndim[3])
dim(feature1)
599*731
feature1=as.matrix(feature1)
feature2=as.matrix(feature2)
feature3=as.matrix(feature3)
feature=cbind(feature1,feature2,feature3)
dim(feature)
feature[is.na(feature)]=0
dim(feature)
getTestFeature <- function(imgName = "name of feature image",WINDOW=c(31,31),SHIFT=c(10,10)){
img0 <-  readImage(imgName)
img1 <- as.matrix(img0[,,1])
img2 <- as.matrix(img0[,,2])
img3 <- as.matrix(img0[,,3])
class(img1) <- "matrix"
class(img2) <- "matrix"
class(img3) <- "matrix"
feature1 <- glcm(raster(img1) , window = WINDOW, shift = SHIFT)
feature2 <- glcm(raster(img2) , window = WINDOW, shift = SHIFT)
feature3 <- glcm(raster(img3) , window = WINDOW, shift = SHIFT)
ndim=dim(feature1)
feature1=as.array(feature1)
feature2=as.array(feature2)
feature3=as.array(feature3)
dim(feature1)=c(ndim[1]*ndim[2],ndim[3])
dim(feature2)=c(ndim[1]*ndim[2],ndim[3])
dim(feature3)=c(ndim[1]*ndim[2],ndim[3])
feature1=as.matrix(feature1)
feature2=as.matrix(feature2)
feature3=as.matrix(feature3)
feature=cbind(feature1,feature2,feature3)
feature[is.na(feature)]=0
return(feature)
}
setwd("C:/Users/Administrator/Desktop/proj 3/try4/test")
imgName="chicken_0039.jpg"
testFeature=getTestFeature(imgName)
img0 <-  readImage(imgName)
dim(img0)
dim(testFeature)
599*731
View(head(testFeature))
testFeature=t(t(testFeature)/scaleSD)
dim(testFeature)
?knn
dim(noiseFeature)
dim(chickFeature)
dim(dogFeature)
dogFeature0=dogFeature[dogInd,]
chickFeature0=chickFeature[chickInd,]
dogInd=sample(1:173262,size=10000,replace = F)
chickInd=sample(1:117518,size=10000,replace = F)
dogFeature0=dogFeature[dogInd,]
chickFeature0=chickFeature[chickInd,]
tag=c(rep("noise",33206),rep("chick",10000),rep("dog",10000))
trainFeature=rbind(noiseFeature,chickFeature,dogFeature)
dim(trainF)
dim(trainFeature)
dim(testFeature)
dim(trainFeature)
dim9tag
dim(tag)
length(tag)
head(tag)
dim(noiseFeature)
dim(chickFeature)
trainFeature=rbind(noiseFeature,chickFeature0,dogFeature0)
dim(trainFeature)
tag=c(rep("noise",33206),rep("chick",10000),rep("dog",10000))
trainFeature=rbind(noiseFeature,chickFeature0,dogFeature0)
ff=knn(train=dogInd,test=testFeature,cl=tag,prob=T)
dim(tag)
length(tag)
dim(trainFeature)
ff=knn(train=trainFeature,test=testFeature,cl=tag,prob=T)
View(testFeature)
View(trainFeature)
scaleSD
scaleSD=apply(temp2,2,sd)
scaleSD
temp2=rbind(dogFeature,chickFeature)
scaleSD=apply(temp2,2,sd)
scaleSD
View(temp2)
dogInd=sample(1:173262,size=10000,replace = F)
chickInd=sample(1:117518,size=10000,replace = F)
dogFeature0=dogFeature[dogInd,]
chickFeature0=chickFeature[chickInd,]
trainFeature=rbind(noiseFeature,chickFeature0,dogFeature0)
View(trainFeature)
View(dogFeature)
View(dogFeature)
dogFeature0=dogFeature[dogInd,]
chickFeature0=chickFeature[chickInd,]
View(noiseFeature)
noiseFeature=t(t(noiseFeature)/scaleSD)
trainFeature=rbind(noiseFeature,chickFeature0,dogFeature0)
apply(trainFeature,2,sd)
apply(noiseFeature,2,sd)
apply(chickFeature0,2,sd)
apply(dogFeature0,2,sd)
scaleSD
setwd("C:/Users/Administrator/Desktop/proj 3/try4/noise")
noiseFeature=matrix(0,ncol=24)
for(i in 1:4){
imgName=sprintf("%d.jpg",i)
temp=getFeature(imgName)
noiseFeature=rbind(noiseFeature,temp)
}
noiseFeature=noiseFeature[-1,]
apply(noiseFeature,2,sd)
library(EBImage)
library(glcm)
library(raster)
library(jpeg)
library(class)
getFeature <- function(imgName = "name of feature image",WINDOW=c(31,31),SHIFT=c(10,10)){
img0 <-  readImage(imgName)
img1 <- as.matrix(img0[,,1])
img2 <- as.matrix(img0[,,2])
img3 <- as.matrix(img0[,,3])
class(img1) <- "matrix"
class(img2) <- "matrix"
class(img3) <- "matrix"
feature1 <- glcm(raster(img1) , window = WINDOW, shift = SHIFT)
feature2 <- glcm(raster(img2) , window = WINDOW, shift = SHIFT)
feature3 <- glcm(raster(img3) , window = WINDOW, shift = SHIFT)
ndim=dim(feature1)
feature1=as.array(feature1)
feature2=as.array(feature2)
feature3=as.array(feature3)
dim(feature1)=c(ndim[1]*ndim[2],ndim[3])
dim(feature2)=c(ndim[1]*ndim[2],ndim[3])
dim(feature3)=c(ndim[1]*ndim[2],ndim[3])
feature1=as.matrix(feature1)
feature2=as.matrix(feature2)
feature3=as.matrix(feature3)
feature=cbind(feature1,feature2,feature3)
feature=na.omit(feature)
return(feature)
}
setwd("C:/Users/Administrator/Desktop/proj 3/try4/fur")
dogFeature=matrix(0,ncol=24)
for(i in 1:6){
imgName=sprintf("%d.jpg",i)
temp=getFeature(imgName)
dogFeature=rbind(dogFeature,temp)
}
dogFeature=dogFeature[-1,]
setwd("C:/Users/Administrator/Desktop/proj 3/try4/chick")
chickFeature=matrix(0,ncol=24)
for(i in 1:6){
imgName=sprintf("%d.jpg",i)
temp=getFeature(imgName)
chickFeature=rbind(chickFeature,temp)
}
chickFeature=chickFeature[-1,]
setwd("C:/Users/Administrator/Desktop/proj 3/try4/noise")
noiseFeature=matrix(0,ncol=24)
for(i in 1:4){
imgName=sprintf("%d.jpg",i)
temp=getFeature(imgName)
noiseFeature=rbind(noiseFeature,temp)
}
noiseFeature=noiseFeature[-1,]
temp2=rbind(dogFeature,chickFeature)
scaleSD=apply(temp2,2,sd)
dogFeature=t(t(dogFeature)/scaleSD)
chickFeature=t(t(chickFeature)/scaleSD)
noiseFeature=t(t(noiseFeature)/scaleSD)
apply(temp2,2,sd)
apply(dogFeature,2,sd)
apply(chickFeature,2,sd)
apply(noiseFeature,2,sd)
getTestFeature <- function(imgName = "name of feature image",WINDOW=c(31,31),SHIFT=c(10,10)){
img0 <-  readImage(imgName)
img1 <- as.matrix(img0[,,1])
img2 <- as.matrix(img0[,,2])
img3 <- as.matrix(img0[,,3])
class(img1) <- "matrix"
class(img2) <- "matrix"
class(img3) <- "matrix"
feature1 <- glcm(raster(img1) , window = WINDOW, shift = SHIFT)
feature2 <- glcm(raster(img2) , window = WINDOW, shift = SHIFT)
feature3 <- glcm(raster(img3) , window = WINDOW, shift = SHIFT)
ndim=dim(feature1)
feature1=as.array(feature1)
feature2=as.array(feature2)
feature3=as.array(feature3)
dim(feature1)=c(ndim[1]*ndim[2],ndim[3])
dim(feature2)=c(ndim[1]*ndim[2],ndim[3])
dim(feature3)=c(ndim[1]*ndim[2],ndim[3])
feature1=as.matrix(feature1)
feature2=as.matrix(feature2)
feature3=as.matrix(feature3)
feature=cbind(feature1,feature2,feature3)
feature[is.na(feature)]=0
return(feature)
}
setwd("C:/Users/Administrator/Desktop/proj 3/try4/test")
imgName="chicken_0039.jpg"
testFeature=getTestFeature(imgName)
testFeature=t(t(testFeature)/scaleSD)
scaleSD
dogInd=sample(1:173262,size=10000,replace = F)
chickInd=sample(1:117518,size=10000,replace = F)
dogFeature0=dogFeature[dogInd,]
chickFeature0=chickFeature[chickInd,]
tag=c(rep("noise",33206),rep("chick",10000),rep("dog",10000))
trainFeature=rbind(noiseFeature,chickFeature0,dogFeature0)
apply(trainFeature,2,sd)
apply(testFeature,2,sd)
testFeature[!abs(testFeature)<Inf]=0
testFeature=t(t(testFeature)/scaleSD)
apply(testFeature,2,sd)
testFeature=getTestFeature(imgName)
testFeature[!abs(testFeature)<Inf]=0
testFeature=t(t(testFeature)/scaleSD)
apply(testFeature,2,sd)
dogInd=sample(1:173262,size=10000,replace = F)
chickInd=sample(1:117518,size=10000,replace = F)
dogFeature0=dogFeature[dogInd,]
chickFeature0=chickFeature[chickInd,]
tag=c(rep("noise",33206),rep("chick",10000),rep("dog",10000))
trainFeature=rbind(noiseFeature,chickFeature0,dogFeature0)
apply(trainFeature,2,sd)
dim(trainFeature)
dim9testFeature
dim(testFeature)
length(tag)
View(trainFeature)
View(testFeature)
tag=c(rep(3,33206),rep(1,10000),rep(2,10000))
trainFeature=rbind(noiseFeature,chickFeature0,dogFeature0)
ff=knn(train=trainFeature,test=testFeature,cl=tag,prob=T)
dim(ff)
names(ff)
length(ff)
head(ff)
save(ff,file="ff.Rdata")
ff0=as.matrix(ff0)
ff0=ff
ff0=as.matrix(ff0)
ff0=as.matrix(ff0,ncol=1)
dim(ff0)
dim(ff0)=c(599,731)
dim(ff0)
image(ff0)
ff1=as.integer(ff0)
image(ff1)
dim(ff1)
ff1=as.numeric(ff0)
dim(ff1)
length(ff1)
ff0=ff
ff0=as.matrix(ff0,ncol=1)
dim(ff0)=c(599,731)
ff1=as.numeric(ff0)
dim(ff1)
ff0=as.matrix(as.numeric(ff0),ncol=1)
ff0=ff
ff0=as.matrix(as.numeric(ff0),ncol=1)
dim(ff0)=c(599,731)
dim(ff0)
ff0[1:20,1:10]
image(ff0)
save.image(ff0,"ff0.Rdata")
save.image(ff0,file="ff0.Rdata")
save(ff0,file="ff0.Rdata")
readImage(imgName)
img000=readImage(imgName)
image(img000[,,3])
par(mfrow=c(1,2))
image(img000[,,3])
image(ff0)
image(c(1,2,3))
image(matrix(c(1,2,3)))
apply(trainFeature,2,range)
?rep
?seq
